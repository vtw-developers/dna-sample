- route:
    id: sample
    auto-startup: true
    from:
      uri: direct://sample
      steps:
        - log: ${body}
        - to:
            uri: http://127.0.0.1:8090/dna/sample/persons?httpMethod=POST
        - unmarshal:
            json:
              library: Jackson
        - log: ${body}
        - set-header:
            name: person
            simple: ${body}
        - log: ${header.person[gender]}
        - choice:
            when:
              - simple: ${header.person[gender]} == 'Female'
                steps:
                  - process:
                      ref: incomeBracketProcessor
                  - choice:
                      when:
                        - simple: ${header.person[gender]} == 'self employment'
                          steps:
                            - set-body:
                                simple: 지원금A
                      when:
                        - simple: ${header.incomeBracket} >= 7
                          steps:
                            - set-body:
                                simple: 지원금B
                      when:
                        - simple: ${header.incomeBracket} >= 3
                          steps:
                            - set-body:
                                simple: 지원금C
                      otherwise:
                        steps:
                          - set-body:
                              simple: 지원금 대상 아님
            when:
              - simple: ${header.person[gender]} == 'Male'
                steps:
                  - process:
                      ref: incomeBracketProcessor
                  - choice:
                      when:
                        - simple: ${header.person[gender]} == 'self employment'
                          steps:
                            - set-body:
                                simple: 지원금D
                      when:
                        - simple: ${header.incomeBracket} >= 7
                          steps:
                            - set-body:
                                simple: 지원금E
                      when:
                        - simple: ${header.incomeBracket} >= 3
                          steps:
                            - set-body:
                                simple: 지원금F
                      otherwise:
                        steps:
                          - set-body:
                              simple: 지원금 대상 아님






        #        - set-body:
        #            simple: test
#      - convertBodyTo:
#          type: String
#      - log: